# LABORATORY TECHNICAL ANALYSIS: INTERNET PROTOCOL (IP)
# ===============================================================
# Author: Amey Thakur
# GitHub: [Amey-Thakur](https://github.com/Amey-Thakur)
# Repository: [COMPUTER-NETWORKS](https://github.com/Amey-Thakur/COMPUTER-NETWORKS)
# Session: Fall 2023
# Release Date: November 07, 2023
# Lab 06: Analyzing IPv4 Header Structures & Fragmentation
# --------------------------------------------------------------

INTRODUCTION:
This technical analysis dissects the Internet Protocol (IP) datagram, focusing on two critical phenomena: the Time-to-Live (TTL) mechanism utilized by Traceroute and the logic of IP Fragmentation when a datagram exceeds the Maximum Transmission Unit (MTU) of a network link.

----------------------------------------------------------------
PART 1: BASIC IPV4 STRUCTURE (TRACEROUTE ANALYSIS)
----------------------------------------------------------------

QUESTION 1: What is the primary IP address of the source computer during the capture?
- IP Address: 192.168.2.95
[EXPLANATION]: This is the local address of the machine executing the 'tracert' (Windows) command.

QUESTION 2: Identify the value in the Time-to-Live (TTL) field for the first ICMP Echo Request.
- TTL Value: 1
[EXPLANATION]: Traceroute begins by sending a packet with TTL=1. When this reaches the first router, the TTL is decremented to 0, forcing the router to drop the packet and send back an "ICMP Time Exceeded" message, thereby revealing its identity to the sender.

QUESTION 3: What is the upper layer protocol specified in this IPv4 datagram's header?
- Protocol: ICMP (1)
[EXPLANATION]: Since 'tracert' on Windows uses ICMP Echo Requests, the Protocol field in the IP header is set to 1. (Note: MacOS/Linux traceroute often uses UDP, protocol 17).

QUESTION 4: What is the size of the IPv4 header?
- Header Length: 20 bytes
[EXPLANATION]: The standard IPv4 header without options is 20 bytes. This is indicated by the 'Header Length' field having a value of 5 (5 * 4-byte words = 20 bytes).

QUESTION 5: How many bytes are in the payload of the IP datagram? Show the calculation.
- Total Length: 92 bytes
- Header Length: 20 bytes
- Payload: 72 bytes (Total Length - Header Length)
[EXPLANATION]: The payload includes the ICMP header and its data.

QUESTION 6: Analysis of Fragmentation flags. Is the datagram fragmented?
- Fragmentation State: No.
- Flags: 0x0 (More Fragments = 0, Don't Fragment = 0).
[EXPLANATION]: Small control packets like ICMP Echo Requests typically fit well within the standard 1500-byte MTU.

QUESTION 7: Which fields in the IP datagram ALWAYS change during a Traceroute sequence?
- Fields: Identification and Time-to-Live (TTL).
[EXPLANATION]: The TTL must increment (1, 2, 3...) to reach progressively further routers. The Identification field increments to allow the source machine to differentiate between the sequence of sent probes.

QUESTION 8: Which fields in the sequence stay constant?
- Fields: Version (4), Header Length (20), Source IP, Destination IP, Protocol (1).
[EXPLANATION]: These define the fundamental communication "contract" for the duration of the Traceroute session.

QUESTION 9: Describe the pattern in the Identification field.
- Pattern: Increments uniformly by 1 for each successive packet sent.
[EXPLANATION]: This sequential behavior is standard for Windows ICMP-based traceroute implementations.

QUESTION 10: Analyze the IP datagrams returned from intervening routers. What is the upper layer protocol?
- Protocol: ICMP (1)
[EXPLANATION]: The routers return "ICMP Type 11, Code 0" (Time Exceeded) messages.

----------------------------------------------------------------
PART 2: IP FRAGMENTATION (3000-BYTE UDP SEGMENT)
----------------------------------------------------------------

QUESTION 13: Analyze the 3000-byte UDP segment. Is it fragmented?
- Status: Yes, it is fragmented into 3 distinct datagrams.
[EXPLANATION]: Since the Maximum Transmission Unit (MTU) of the Ethernet link is 1500 bytes, a 3000-byte payload (plus headers) must be split into multiple fragments.

QUESTION 14: What header information indicates that this datagram has been fragmented?
- Indicator: The "More Fragments" (MF) flag is set to 1.
[EXPLANATION]: This signal tells the destination host that more parts of the original datagram are still to arrive.

QUESTION 15: How can you identify the FIRST fragment versus subsequent ones?
- Indicator: The 'Fragment Offset' field is set to 0.
[EXPLANATION]: An offset of 0 indicates this is the start of the original payload.

QUESTION 16: Analyze the size of the first fragment.
- Total Length: 1500 bytes (standard MTU).
- Payload: 1480 bytes (1500 - 20 byte header).
[EXPLANATION]: The router packs as much data as possible into the MTU-sized frame.

QUESTION 17: Identify the second fragment indicator.
- Fragment Offset: 1480.
[EXPLANATION]: This tells the receiver to begin reassembling this data starting at byte 1480 of the original payload.

QUESTION 18: Which fields change between the first and second fragment?
- Fields: Header Checksum and Fragmentation Offset.
[EXPLANATION]: The Checksum differs because the header contents (specifically the offset) have changed.

QUESTION 19: How do you identify the LAST fragment in the sequence?
- Indicators: The "More Fragments" flag is set to 0, but the Fragment Offset is non-zero (2960). The Identification field (e.g., 0x4890) remains constant across all fragments.
[EXPLANATION]: The constant Identification field allows the receiver to group all fragments together for reassembly.

==============================================================
TECHNICAL CONCLUSION:
This analysis underscores the robustness of the IP protocol in handling varying network conditions. Whether through TTL-based discovery or the mechanics of fragmentation, IP provides the necessary metadata for Layer 3 devices to manage path discovery and data delivery across heterogeneous links.
==============================================================
